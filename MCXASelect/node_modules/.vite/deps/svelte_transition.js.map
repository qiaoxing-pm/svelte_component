{"version":3,"file":"svelte_transition.js","names":["DEV","crossfade","d"],"sources":["../../svelte/src/transition/index.js"],"sourcesContent":["/** @import { BlurParams, CrossfadeParams, DrawParams, FadeParams, FlyParams, ScaleParams, SlideParams, TransitionConfig } from './public' */\n\nimport { DEV } from 'esm-env';\nimport * as w from '../internal/client/warnings.js';\n\n/** @param {number} x */\nconst linear = (x) => x;\n\n/** @param {number} t */\nfunction cubic_out(t) {\n\tconst f = t - 1.0;\n\treturn f * f * f + 1.0;\n}\n\n/**\n * @param {number} t\n * @returns {number}\n */\nfunction cubic_in_out(t) {\n\treturn t < 0.5 ? 4.0 * t * t * t : 0.5 * Math.pow(2.0 * t - 2.0, 3.0) + 1.0;\n}\n\n/** @param {number | string} value\n * @returns {[number, string]}\n */\nfunction split_css_unit(value) {\n\tconst split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n\treturn split ? [parseFloat(split[1]), split[2] || 'px'] : [/** @type {number} */ (value), 'px'];\n}\n\n/**\n * Animates a `blur` filter alongside an element's opacity.\n *\n * @param {Element} node\n * @param {BlurParams} [params]\n * @returns {TransitionConfig}\n */\nexport function blur(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubic_in_out, amount = 5, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst f = style.filter === 'none' ? '' : style.filter;\n\tconst od = target_opacity * (1 - opacity);\n\tconst [value, unit] = split_css_unit(amount);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_t, u) => `opacity: ${target_opacity - od * u}; filter: ${f} blur(${u * value}${unit});`\n\t};\n}\n\n/**\n * Animates the opacity of an element from 0 to the current opacity for `in` transitions and from the current opacity to 0 for `out` transitions.\n *\n * @param {Element} node\n * @param {FadeParams} [params]\n * @returns {TransitionConfig}\n */\nexport function fade(node, { delay = 0, duration = 400, easing = linear } = {}) {\n\tconst o = +getComputedStyle(node).opacity;\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t) => `opacity: ${t * o}`\n\t};\n}\n\n/**\n * Animates the x and y positions and the opacity of an element. `in` transitions animate from the provided values, passed as parameters to the element's default values. `out` transitions animate from the element's default values to the provided values.\n *\n * @param {Element} node\n * @param {FlyParams} [params]\n * @returns {TransitionConfig}\n */\nexport function fly(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubic_out, x = 0, y = 0, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst transform = style.transform === 'none' ? '' : style.transform;\n\tconst od = target_opacity * (1 - opacity);\n\tconst [x_value, x_unit] = split_css_unit(x);\n\tconst [y_value, y_unit] = split_css_unit(y);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t, u) => `\n\t\t\ttransform: ${transform} translate(${(1 - t) * x_value}${x_unit}, ${(1 - t) * y_value}${y_unit});\n\t\t\topacity: ${target_opacity - od * u}`\n\t};\n}\n\nvar slide_warning = false;\n\n/**\n * Slides an element in and out.\n *\n * @param {Element} node\n * @param {SlideParams} [params]\n * @returns {TransitionConfig}\n */\nexport function slide(node, { delay = 0, duration = 400, easing = cubic_out, axis = 'y' } = {}) {\n\tconst style = getComputedStyle(node);\n\n\tif (DEV && !slide_warning && /(contents|inline|table)/.test(style.display)) {\n\t\tslide_warning = true;\n\t\tPromise.resolve().then(() => (slide_warning = false));\n\t\tw.transition_slide_display(style.display);\n\t}\n\n\tconst opacity = +style.opacity;\n\tconst primary_property = axis === 'y' ? 'height' : 'width';\n\tconst primary_property_value = parseFloat(style[primary_property]);\n\tconst secondary_properties = axis === 'y' ? ['top', 'bottom'] : ['left', 'right'];\n\tconst capitalized_secondary_properties = secondary_properties.map(\n\t\t(e) => /** @type {'Left' | 'Right' | 'Top' | 'Bottom'} */ (`${e[0].toUpperCase()}${e.slice(1)}`)\n\t);\n\tconst padding_start_value = parseFloat(style[`padding${capitalized_secondary_properties[0]}`]);\n\tconst padding_end_value = parseFloat(style[`padding${capitalized_secondary_properties[1]}`]);\n\tconst margin_start_value = parseFloat(style[`margin${capitalized_secondary_properties[0]}`]);\n\tconst margin_end_value = parseFloat(style[`margin${capitalized_secondary_properties[1]}`]);\n\tconst border_width_start_value = parseFloat(\n\t\tstyle[`border${capitalized_secondary_properties[0]}Width`]\n\t);\n\tconst border_width_end_value = parseFloat(\n\t\tstyle[`border${capitalized_secondary_properties[1]}Width`]\n\t);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (t) =>\n\t\t\t'overflow: hidden;' +\n\t\t\t`opacity: ${Math.min(t * 20, 1) * opacity};` +\n\t\t\t`${primary_property}: ${t * primary_property_value}px;` +\n\t\t\t`padding-${secondary_properties[0]}: ${t * padding_start_value}px;` +\n\t\t\t`padding-${secondary_properties[1]}: ${t * padding_end_value}px;` +\n\t\t\t`margin-${secondary_properties[0]}: ${t * margin_start_value}px;` +\n\t\t\t`margin-${secondary_properties[1]}: ${t * margin_end_value}px;` +\n\t\t\t`border-${secondary_properties[0]}-width: ${t * border_width_start_value}px;` +\n\t\t\t`border-${secondary_properties[1]}-width: ${t * border_width_end_value}px;` +\n\t\t\t`min-${primary_property}: 0`\n\t};\n}\n\n/**\n * Animates the opacity and scale of an element. `in` transitions animate from the provided values, passed as parameters, to an element's current (default) values. `out` transitions animate from an element's default values to the provided values.\n *\n * @param {Element} node\n * @param {ScaleParams} [params]\n * @returns {TransitionConfig}\n */\nexport function scale(\n\tnode,\n\t{ delay = 0, duration = 400, easing = cubic_out, start = 0, opacity = 0 } = {}\n) {\n\tconst style = getComputedStyle(node);\n\tconst target_opacity = +style.opacity;\n\tconst transform = style.transform === 'none' ? '' : style.transform;\n\tconst sd = 1 - start;\n\tconst od = target_opacity * (1 - opacity);\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_t, u) => `\n\t\t\ttransform: ${transform} scale(${1 - sd * u});\n\t\t\topacity: ${target_opacity - od * u}\n\t\t`\n\t};\n}\n\n/**\n * Animates the stroke of an SVG element, like a snake in a tube. `in` transitions begin with the path invisible and draw the path to the screen over time. `out` transitions start in a visible state and gradually erase the path. `draw` only works with elements that have a `getTotalLength` method, like `<path>` and `<polyline>`.\n *\n * @param {SVGElement & { getTotalLength(): number }} node\n * @param {DrawParams} [params]\n * @returns {TransitionConfig}\n */\nexport function draw(node, { delay = 0, speed, duration, easing = cubic_in_out } = {}) {\n\tlet len = node.getTotalLength();\n\tconst style = getComputedStyle(node);\n\tif (style.strokeLinecap !== 'butt') {\n\t\tlen += parseInt(style.strokeWidth);\n\t}\n\tif (duration === undefined) {\n\t\tif (speed === undefined) {\n\t\t\tduration = 800;\n\t\t} else {\n\t\t\tduration = len / speed;\n\t\t}\n\t} else if (typeof duration === 'function') {\n\t\tduration = duration(len);\n\t}\n\treturn {\n\t\tdelay,\n\t\tduration,\n\t\teasing,\n\t\tcss: (_, u) => `\n\t\t\tstroke-dasharray: ${len};\n\t\t\tstroke-dashoffset: ${u * len};\n\t\t`\n\t};\n}\n\n/**\n * @template T\n * @template S\n * @param {T} tar\n * @param {S} src\n * @returns {T & S}\n */\nfunction assign(tar, src) {\n\t// @ts-ignore\n\tfor (const k in src) tar[k] = src[k];\n\treturn /** @type {T & S} */ (tar);\n}\n\n/**\n * The `crossfade` function creates a pair of [transitions](https://svelte.dev/docs/svelte/transition) called `send` and `receive`. When an element is 'sent', it looks for a corresponding element being 'received', and generates a transition that transforms the element to its counterpart's position and fades it out. When an element is 'received', the reverse happens. If there is no counterpart, the `fallback` transition is used.\n *\n * @param {CrossfadeParams & {\n * \tfallback?: (node: Element, params: CrossfadeParams, intro: boolean) => TransitionConfig;\n * }} params\n * @returns {[(node: any, params: CrossfadeParams & { key: any; }) => () => TransitionConfig, (node: any, params: CrossfadeParams & { key: any; }) => () => TransitionConfig]}\n */\nexport function crossfade({ fallback, ...defaults }) {\n\t/** @type {Map<any, Element>} */\n\tconst to_receive = new Map();\n\t/** @type {Map<any, Element>} */\n\tconst to_send = new Map();\n\n\t/**\n\t * @param {Element} from_node\n\t * @param {Element} node\n\t * @param {CrossfadeParams} params\n\t * @returns {TransitionConfig}\n\t */\n\tfunction crossfade(from_node, node, params) {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = /** @param {number} d */ (d) => Math.sqrt(d) * 30,\n\t\t\teasing = cubic_out\n\t\t} = assign(assign({}, defaults), params);\n\t\tconst from = from_node.getBoundingClientRect();\n\t\tconst to = node.getBoundingClientRect();\n\t\tconst dx = from.left - to.left;\n\t\tconst dy = from.top - to.top;\n\t\tconst dw = from.width / to.width;\n\t\tconst dh = from.height / to.height;\n\t\tconst d = Math.sqrt(dx * dx + dy * dy);\n\t\tconst style = getComputedStyle(node);\n\t\tconst transform = style.transform === 'none' ? '' : style.transform;\n\t\tconst opacity = +style.opacity;\n\t\treturn {\n\t\t\tdelay,\n\t\t\tduration: typeof duration === 'function' ? duration(d) : duration,\n\t\t\teasing,\n\t\t\tcss: (t, u) => `\n\t\t\t   opacity: ${t * opacity};\n\t\t\t   transform-origin: top left;\n\t\t\t   transform: ${transform} translate(${u * dx}px,${u * dy}px) scale(${t + (1 - t) * dw}, ${\n\t\t\t\t\t\tt + (1 - t) * dh\n\t\t\t\t\t});\n\t\t   `\n\t\t};\n\t}\n\n\t/**\n\t * @param {Map<any, Element>} items\n\t * @param {Map<any, Element>} counterparts\n\t * @param {boolean} intro\n\t * @returns {(node: any, params: CrossfadeParams & { key: any; }) => () => TransitionConfig}\n\t */\n\tfunction transition(items, counterparts, intro) {\n\t\t// @ts-expect-error TODO improve typings (are the public types wrong?)\n\t\treturn (node, params) => {\n\t\t\titems.set(params.key, node);\n\t\t\treturn () => {\n\t\t\t\tif (counterparts.has(params.key)) {\n\t\t\t\t\tconst other_node = counterparts.get(params.key);\n\t\t\t\t\tcounterparts.delete(params.key);\n\t\t\t\t\treturn crossfade(/** @type {Element} */ (other_node), node, params);\n\t\t\t\t}\n\t\t\t\t// if the node is disappearing altogether\n\t\t\t\t// (i.e. wasn't claimed by the other list)\n\t\t\t\t// then we need to supply an outro\n\t\t\t\titems.delete(params.key);\n\t\t\t\treturn fallback && fallback(node, params, intro);\n\t\t\t};\n\t\t};\n\t}\n\treturn [transition(to_send, to_receive, false), transition(to_receive, to_send, true)];\n}\n"],"mappings":"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"}